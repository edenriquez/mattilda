generator client {
    provider             = "prisma-client-py"
    recursive_type_depth = 5
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model schools {
    id        Int        @id @default(autoincrement())
    name      String     @unique
    createdAt DateTime   @default(now())
    students  students[]

    @@index([name])
}

// NOTES:
// One student only belongs to one school thats why i created this foreign key and not a many to many relationship
// When serching for students there should be these scenarios
// 1. Search student by name
// 2. Filter students by school
// 3. Search student by school and name

model students {
    id        Int        @id @default(autoincrement())
    name      String
    schoolId  Int
    createdAt DateTime   @default(now())
    school    schools    @relation(fields: [schoolId], references: [id], onDelete: Cascade)
    invoices  invoices[]

    @@index([name])
    @@index([schoolId])
    @@index([schoolId, name])
}

model invoices {
    id        Int      @id @default(autoincrement())
    studentId Int
    name      String
    amount    BigInt
    paid      Boolean  @default(false)
    createdAt DateTime @default(now())
    student   students @relation(fields: [studentId], references: [id], onDelete: Cascade)

    @@index([studentId])
    @@index([studentId, amount])
}
